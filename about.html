<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>æœ¨è‘‰ã¯ã¥ã ğŸ¦‰ HAZUQU</title>
    <meta name="description" content="æ˜ åƒã‚’ã—ã¦ã„ã¾ã™ğŸ">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="style.css">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="æœ¨è‘‰ã¯ã¥ã Portfolio">
    <meta name="twitter:description" content="æ˜ åƒã‚’ã—ã¦ã„ã¾ã™ğŸ">
    <meta name="twitter:image" content="https://hazuqu.github.io/icon.jpg">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.js"></script>
</head>

<body>
    <header>
        <div id="ãƒ˜ãƒƒãƒ€ãƒ¼"></div>
    </header>
    <main>
        <div class="ãŠãŠããªåˆ†é¡">
            <div class="youtube">
                <iframe src="https://www.youtube.com/embed/NctffbWZ23w?loop=1&controls=1" title="YouTube video player"
                    allow="autoplay; encrypted-media" allowfullscreen></iframe>
            </div>
            <div class="ã¡ã‚…ã†ãã‚‰ã„ã®åˆ†é¡">
                <div class="åå‰">
                    HAZUQU<br>
                    <h5>æœ¨è‘‰ã¯ã¥ã</h5>
                </div>

                <p class="tags">MV, PV, Live Back</p>

                <div class="å°ã•ãªåˆ†é¡">
                    <a href="https://twitter.com/HAZUQU">Twitter</a>
                    <a href="https://youtube.com/playlist?list=PLxZ7R-HAwPeOob8qWX81nsFZ2a5HxjX51">Youtube</a>
                </div>
            </div>
            <div class="ã¡ã‚…ã†ãã‚‰ã„ã®åˆ†é¡">
                VTuberã€Vsingerä¸­å¿ƒã«ãƒŸãƒ¥ãƒ¼ã‚¸ãƒƒã‚¯ãƒ“ãƒ‡ã‚ªã‚’ä½œã£ã¦ã„ã¾ã™ã€‚æœ€è¿‘ã¯ãƒœã‚«ãƒ­ã«ã‚‚æ˜ åƒã‚’ä»˜ã‘ã¦ã„ã¾ã™ã€‚<br>
                ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚„å®Ÿå†™ã‚’ã‚„ã£ãŸã‚Šã€å‹äººã«çµµã‚’æã„ã¦ã‚‚ã‚‰ã£ãŸã‚Šã€ã„ã‚ã„ã‚ã¨ã‚„ã‚Šã¾ã™ã€‚
            </div>
        </div>
        <div class="ãŠãŠããªåˆ†é¡">
            <h1>åˆ¶ä½œãƒªã‚¹ãƒˆ</h1>
            <input type="text" id="search" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢...">

            <table id="json-table">
                <thead>
                    <tr>
                        <th data-key="date">ã„ã¤</th>
                        <th data-key="user">ã©ã‚“ãªã‚‚ã®ã‚’</th>
                        <th data-key="credit">ã©ã†ã‚„ã£ã¦</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </main>
    <script>
        const tbody = document.querySelector("#json-table tbody");
        const searchInput = document.getElementById("search");
        let data = [];
        let sortState = {};

        function renderTable(filteredData) {
            tbody.innerHTML = "";
            filteredData
                .filter(item => !item.status || item.status.trim() === "")
                .forEach(item => {
                    const tr = document.createElement("tr");
                    const date = item.date?.split("/").slice(0, 2).map((s, i) => i ? s.padStart(2, "0") : s).join("/") || "";
                    const creditHTML = (item.credit || []).map(c => `<span class="credit-tag">${c}</span>`).join("");

                    const userTitle = `${item.user || ""}${item.user && item.title ? " - " : ""}${item.title || ""}`;

                    const userTitleHTML = item.link
                        ? `<a href="${item.link}" target="_blank" rel="noopener noreferrer">${userTitle}</a>`
                        : userTitle;

                    const cover = item.Cover || "";

                    tr.innerHTML = `
                <td>${date}</td>
                <td>${userTitleHTML} ${cover}</td>
                <td>${creditHTML}</td>
            `;
                    tbody.appendChild(tr);
                });
        }


        function sortByKey(key) {
            const direction = sortState[key] === "asc" ? "desc" : "asc";
            sortState = { [key]: direction };

            const sorted = [...data].sort((a, b) => {
                const valA = (key === "date") ? new Date(a[key]) : (a[key] || "").toString().toLowerCase();
                const valB = (key === "date") ? new Date(b[key]) : (b[key] || "").toString().toLowerCase();

                if (valA < valB) return direction === "asc" ? -1 : 1;
                if (valA > valB) return direction === "asc" ? 1 : -1;
                return 0;
            });

            renderTable(applySearch(sorted));
        }

        function applySearch(dataArray) {
            const keyword = searchInput.value.trim().toLowerCase();
            if (keyword === "") return dataArray;

            return dataArray.filter(item => {
                return Object.values(item).some(val => {
                    if (Array.isArray(val)) {
                        return val.some(v => v.toLowerCase().includes(keyword));
                    }
                    return (val || "").toString().toLowerCase().includes(keyword);
                });
            });
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
        document.querySelectorAll("th[data-key]").forEach(th => {
            th.addEventListener("click", () => sortByKey(th.getAttribute("data-key")));
        });

        searchInput.addEventListener("input", () => {
            renderTable(applySearch(data));
        });

        // å¤–éƒ¨JSONã‚’èª­ã¿è¾¼ã¿
        fetch("Hazuqu_works.json")
            .then(response => response.json())
            .then(json => {
                data = json;
                renderTable(data);
            })
            .catch(error => {
                console.error("JSONã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:", error);
                tbody.innerHTML = "<tr><td colspan='7'>ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</td></tr>";
            });
    </script>
    <script src="JS.js"></script>
</body>

</html>